<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Trinity ‚Äî Comosny</title>
  <!-- Load Tailwind CSS for utility classes -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root{
      --bg:#000;
      --card:#0b0b0b;
      --muted:#9aa0a6;
      --gold:#d4af37;
      --cyan:#00e0ff;
      --glass: rgba(255,255,255,0.04);
      --max-width:1200px;
      font-family: 'Montserrat', sans-serif;
    }
    /* Google Font */
    @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&display=swap');
    
    html,body{height:100%;margin:0;background:var(--bg);color:#fff;-webkit-font-smoothing:antialiased}
    a{color:inherit;text-decoration:none}
    .container{max-width:var(--max-width);margin:0 auto;padding:0 20px}
    
    /* Header & Navigation */
    header{display:flex;align-items:center;justify-content:space-between;padding:18px 0;z-index:60;position:sticky;top:0;background:rgba(0,0,0,0.9);backdrop-filter:blur(4px)}
    .logo{display:flex;align-items:center;gap:12px}
    .logo img{height:48px;display:block}
    nav{display:flex;gap:12px}
    .btn-ghost{padding:8px 14px;border-radius:10px;border:1px solid rgba(255,255,255,0.06);color:var(--muted);background:transparent;cursor:pointer;transition:all .15s}
    .btn-ghost:hover,.btn-ghost.active{color:var(--cyan);border-color:rgba(0,224,255,0.12)}
    
    /* Hero */
    .hero{position:relative;height:78vh;min-height:400px;display:flex;align-items:center;justify-content:center;overflow:hidden;padding-top:40px}
    .video-bg{position:absolute;inset:0;object-fit:cover;width:100%;height:100%;filter:brightness(.35);z-index:0}
    .overlay{position:absolute;inset:0;background:linear-gradient(180deg,transparent 10%, rgba(0,0,0,0.45) 60%, rgba(0,0,0,0.8) 100%);z-index:1}
    .hero-content{position:relative;z-index:2;text-align:center;max-width:900px;padding:0 20px}
    h1{margin:0;font-size:clamp(26px,5vw,48px);color:var(--gold);font-weight:800;line-height:1.02}
    p.lead{color:var(--muted);margin-top:12px;margin-bottom:20px;font-size:clamp(14px,1.7vw,18px)}
    .cta-row{display:flex;gap:12px;justify-content:center;flex-wrap:wrap;margin-top:18px}
    .btn-primary{background:var(--gold);color:#000;padding:12px 22px;border-radius:999px;font-weight:700;cursor:pointer;border:none;box-shadow:0 6px 18px rgba(212,175,55,0.18);transition:transform .14s, box-shadow .14s}
    .btn-primary:hover{transform:translateY(-3px);box-shadow:0 8px 24px rgba(212,175,55,0.25)}
    .btn-primary:disabled{opacity:0.6;cursor:not-allowed;transform:none;box-shadow:none}
    .btn-outline{padding:10px 18px;border-radius:999px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:var(--muted);transition:all .15s}
    .btn-outline:hover{border-color:var(--cyan);color:#fff}
    
    /* video card */
    .video-card{max-width:920px;margin:18px auto 0;border-radius:14px;overflow:hidden;border:1px solid rgba(255,255,255,0.04);box-shadow:0 20px 60px rgba(0,0,0,0.6);position:relative}
    .video-controls{position:absolute;right:12px;bottom:12px;display:flex;gap:8px;z-index:3}
    .micro-btn{background:rgba(0,0,0,0.55);padding:8px 10px;border-radius:999px;color:#fff;border:1px solid rgba(255,255,255,0.04);cursor:pointer;transition:all .15s}
    .micro-btn:hover{background:rgba(255,255,255,0.03)}
    
    /* small intro */
    .intro{padding:28px 0 40px;text-align:center;color:var(--muted)}
    
    /* Banner */
    .banner{display:flex;justify-content:center;padding:18px 0}
    .banner img{max-width:100%;height:auto;border-radius:12px;border:1px solid rgba(255,255,255,0.04)}
    
    /* Packs & Blog Grid */
    .page-section{padding:40px 0 80px}
    .grid{display:grid;grid-template-columns:1fr;gap:18px}
    @media(min-width:640px){.grid-packs{grid-template-columns:repeat(2,1fr)}}
    @media(min-width:880px){.grid-packs{grid-template-columns:repeat(3,1fr)}}
    
    /* Cards */
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:14px;padding:20px;border:1px solid rgba(255,255,255,0.04);display:flex;flex-direction:column;height:100%;transition:transform .2s}
    .card:hover{transform:translateY(-4px)}
    .card h3{margin:0;font-size:20px}
    .price{font-weight:800;font-size:20px;margin-top:12px;color:var(--gold)}
    .details{margin:12px 0;color:var(--muted);flex:1}
    .card button{margin-top:12px}
    .highlight{border:1px solid rgba(212,175,55,0.18);box-shadow:0 10px 30px rgba(212,175,55,0.06)}

    /* Blog Specific */
    .article-card{border:1px solid rgba(255,255,255,0.06); padding:20px; border-radius:12px; background:var(--card); transition:background .2s, border-color .2s}
    .article-card:hover{background:rgba(255,255,255,0.02); border-color:var(--gold)}
    .article-card h4{font-size:22px; color:#fff; margin-bottom:8px}
    .article-meta{font-size:12px; color:var(--cyan); margin-bottom:12px; font-weight:600}
    .read-more{color:var(--gold); font-weight:600; display:inline-block; margin-top:10px}
    
    /* Modal */
    .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.72);backdrop-filter:blur(6px);display:flex;align-items:center;justify-content:center;z-index:120;opacity:0;pointer-events:none;transition:opacity .22s}
    .modal-backdrop.open{opacity:1;pointer-events:auto}
    .modal{width:92%;max-width:560px;background:#0f1113;border-radius:14px;padding:20px;border:1px solid rgba(212,175,55,0.08);box-shadow:0 0 40px rgba(212,175,55,0.1), 0 30px 80px rgba(0,0,0,0.6);position:relative;}
    .modal-lg{max-width:800px; max-height: 90vh; display: flex; flex-direction: column;}
    .modal h4{margin:0 0 8px;color:var(--gold)}
    .field{margin-bottom:10px}
    .field input[type="text"],.field input[type="email"]{width:100%;padding:12px;border-radius:10px;background:#0b0d0f;border:1px solid rgba(255,255,255,0.04);color:#fff;outline:none;transition:border-color .15s}
    .field input[type="text"]:focus,.field input[type="email"]:focus{border-color:var(--cyan)}
    .radios{display:flex;flex-direction:column;gap:8px;color:var(--muted);font-size:14px}
    .radios label{cursor:pointer;padding:4px 0}
    .result{margin-top:12px;padding:14px;border-radius:10px;background:linear-gradient(180deg, rgba(212,175,55,0.05), rgba(0,0,0,0.08));border:1px solid rgba(212,175,55,0.1)}
    .result h5{margin:0;font-size:18px}
    .result p{color:var(--muted);margin:8px 0 12px;line-height:1.4}
    .small{font-size:13px;color:var(--muted)}
    
    /* Floating chat */
    .chat{position:fixed;right:18px;bottom:18px;width:56px;height:56px;border-radius:999px;background:var(--cyan);display:flex;align-items:center;justify-content:center;color:#000;z-index:140;cursor:pointer;box-shadow:0 12px 30px rgba(0,224,255,0.25);transition:transform .15s}
    .chat:hover{transform:scale(1.05)}
    
    /* Article Content Specific */
    #articleContent {
      overflow-y: auto;
      padding-right: 10px;
    }
    #articleContent h5 {
      color: var(--gold);
      font-weight: 700;
      margin-top: 15px;
      font-size: 16px;
    }
    #articleContent p {
      line-height: 1.6;
      margin-bottom: 10px;
      color: var(--muted);
      font-size: 15px;
    }

    /* util */
    .hidden{display:none}
    .muted{color:var(--muted)}
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    .spinner {
      display: inline-block;
      animation: spin 1s linear infinite;
    }

    .page-view.hidden {
      display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header>
      <!-- Logo as a link to Home -->
      <a href="/" data-link="/" class="logo">
        <img src="https://placehold.co/48x48/d4af37/000?text=TRN" alt="Comosny logo" style="height:48px;width:auto;border-radius:8px;object-fit:cover">
        <div class="small muted">Comosny ‚Äî Trinity</div>
      </a>

      <nav aria-label="Main navigation">
        <!-- Using data-link for client-side routing -->
        <button class="btn-ghost" data-link="/packs">Packs</button>
        <button class="btn-ghost" data-link="/blog">Blog</button>
      </nav>
    </header>
  </div>
  
  <main id="app-content">
    <!-- View 1: HOME -->
    <div data-view="home" class="page-view">
      <!-- HERO -->
      <section class="hero">
        <!-- video background (Placeholder Video) -->
        <video id="heroVideo" class="video-bg" autoplay muted loop playsinline preload="metadata">
          <source src="https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerJoyrides.mp4" type="video/mp4">
          Tu navegador no soporta video.
        </video>

        <div class="overlay"></div>

        <div class="container hero-content">
          <!-- UPDATED COPY: Beneficio y Dolor -->
          <h1>De la Par√°lisis a la Estrategia: Desbloquea tu Siguiente Nivel con Trinity IA</h1>
          <p class="lead">Deja de adivinar. Obt√©n tu diagn√≥stico estrat√©gico claro y listo para ejecutar en menos de 60 segundos.</p>

          <div class="cta-row">
            <button class="btn-primary" id="openDiagBtn">Descubrir mi punto de bloqueo ‚Üí</button>
            <!-- Link to Packs page using data-link -->
            <button class="btn-outline" data-link="/packs">Ver Paquetes</button>
          </div>

          <div class="video-card" style="margin-top:22px;">
            <div style="height:220px;display:flex;align-items:center;justify-content:center;color:var(--muted);">
              <span class="muted text-sm">Transmisi√≥n Trinity ‚Äî presentaci√≥n</span>
            </div>

            <!-- Controls (sobre el hero) -->
            <div class="video-controls">
              <button id="playPauseBtn" class="micro-btn">Pause</button>
              <button id="muteBtn" class="micro-btn">Unmute</button>
            </div>
          </div>
        </div>
      </section>

      <!-- small intro -->
      <section class="intro container">
        <p>Este diagn√≥stico es una experiencia breve de autoconocimiento estrat√©gico ‚Äî nada de etiquetas, solo claridad para tu siguiente paso.</p>
      </section>

      <!-- Banner LinkedIn (visual) (Placeholder Image) -->
      <section class="banner container">
        <img src="https://placehold.co/1584x396/0f1113/d4af37?text=Trinity+Core+Strategy" alt="Banner Comosny - Trinity Core Strategy">
      </section>
    </div> <!-- end data-view="home" -->
    
    <!-- View 2: PACKS -->
    <div data-view="packs" class="page-view hidden">
      <section class="page-section container" aria-labelledby="packs-title">
        <h2 id="packs-title" style="text-align:center;margin:28px 0 18px;font-size:clamp(24px, 4vw, 32px);">üí∞ Paquetes de Crecimiento</h2>
        <p class="intro">Elige tu punto de despegue. Todos nuestros paquetes incluyen la inteligencia de Trinity para una ejecuci√≥n precisa.</p>
        <div class="grid grid-packs">
          <!-- Impulso -->
          <div class="card">
            <h3>üöÄ Impulso</h3>
            <div class="small muted" style="margin-top:6px">Paquete de entrada</div>
            <details style="margin:12px 0;color:var(--muted)">
              <summary style="cursor:pointer;color:var(--gold);font-weight:600">Ver beneficios</summary>
              <ul style="margin:8px 0 0;padding-left:18px;color:var(--muted);margin-top:6px">
                <!-- UPDATED BENEFIT COPY -->
                <li>‚úÖ **Atracci√≥n Garantizada:** Lanzamiento de 1 campa√±a digital rentable.</li>
                <li>‚úÖ **Conversi√≥n Inmediata:** 1 landing page optimizada para captaci√≥n.</li>
                <li>‚úÖ **Base de Datos Organizada:** Configuraci√≥n inicial de tu CRM.</li>
                <li>‚úÖ **Visibilidad:** Reporte de m√©tricas clave.</li>
                <li>‚ùå **Focus Estrat√©gico:** No incluye optimizaci√≥n continua (ideal para tests iniciales).</li>
              </ul>
            </details>
            <!-- UPDATED SUMMARY COPY -->
            <div class="details">Ideal para: validar mercados, generar primeras bases de datos y establecer tu primera ruta digital con una inversi√≥n controlada.</div>
            <div class="price">$800 USD / mes</div>
            <button class="btn-primary" onclick="openModalWithPackage('impulso')">Empezar</button>
          </div>

          <!-- Crecimiento -->
          <div class="card highlight">
            <h3>üìà Crecimiento</h3>
            <div class="small muted" style="margin-top:6px">üî• M√°s elegido</div>
            <details style="margin:12px 0;color:var(--muted)">
              <summary style="cursor:pointer;color:var(--gold);font-weight:600">Ver beneficios</summary>
              <ul style="margin:8px 0 0;padding-left:18px;color:var(--muted);margin-top:6px">
                <!-- UPDATED BENEFIT COPY -->
                <li>‚úÖ **Consolidaci√≥n:** Todo lo incluido en el Paquete Impulso.</li>
                <li>‚úÖ **Escala Continua:** Gesti√≥n, optimizaci√≥n y escalado mensual de campa√±as.</li>
                <li>‚úÖ **Eficiencia 24/7:** Automatizaci√≥n de 2 flujos clave (ej. bienvenida/abandono de carrito).</li>
                <li>‚úÖ **Control Total:** Dashboard en tiempo real con KPIs esenciales.</li>
              </ul>
            </details>
            <!-- UPDATED SUMMARY COPY -->
            <div class="details">Ideal para: escalar resultados consistentemente, automatizar el 80% del proceso de venta y convertir el tr√°fico en clientes recurrentes.</div>
            <div class="price">$1,500 USD / mes</div>
            <button class="btn-primary" onclick="openModalWithPackage('crecimiento')">Elegir este</button>
          </div>

          <!-- Dominio -->
          <div class="card">
            <h3>üèÜ Dominio</h3>
            <div class="small muted" style="margin-top:6px">üëë Full Stack Marketing</div>
            <details style="margin:12px 0;color:var(--muted)">
              <summary style="cursor:pointer;color:var(--gold);font-weight:600">Ver beneficios</summary>
              <ul style="margin:8px 0 0;padding-left:18px;color:var(--muted);margin-top:6px">
                <!-- UPDATED BENEFIT COPY -->
                <li>‚úÖ **Ecosistema Completo:** Todo lo de Crecimiento y Fidelizaci√≥n.</li>
                <li>‚úÖ **Liderazgo de Marca:** Estrategia integral de posicionamiento y comunicaci√≥n.</li>
                <li>‚úÖ **Sinergia Total:** Activaci√≥n de canales online y offline unificados.</li>
                <li>‚úÖ **Socio Estrat√©gico:** Equipo dedicado, sesiones estrat√©gicas quincenales y soporte prioritario.</li>
              </ul>
            </details>
            <!-- UPDATED SUMMARY COPY -->
            <div class="details">Ideal para: dominar tu nicho de mercado, transformar tu marca en un activo de alto valor y asegurar la fidelizaci√≥n a largo plazo.</div>
            <div class="price">$4,000 USD / mes</div>
            <button class="btn-primary" onclick="openModalWithPackage('dominio')">Agendar reuni√≥n</button>
          </div>
        </div>
      </section>
    </div> <!-- end data-view="packs" -->

    <!-- View 3: BLOG -->
    <div data-view="blog" class="page-view hidden">
      <section class="page-section container" aria-labelledby="blog-title">
        <h2 id="blog-title" style="text-align:center;margin:28px 0 18px;font-size:clamp(24px, 4vw, 32px);">üß† Insights de Trinity</h2>
        <p class="intro">Art√≠culos estrat√©gicos y an√°lisis profundos para tu crecimiento digital.</p>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          <!-- Article 1: CRM -->
          <div class="article-card">
            <h4>El Futuro del CRM: Automatizaci√≥n y Personalizaci√≥n</h4>
            <div class="article-meta" id="meta-crm">Estrategia | 12 de Octubre, 2025 | 5 min lectura</div>
            <!-- UPDATED BLOG COPY -->
            <p class="muted text-sm">El CRM ya no es un registro, es un predictor. Analizamos c√≥mo **Trinity integra la IA para anticipar el comportamiento de tus clientes**, automatizar las interacciones de alto valor y crear un ciclo de lealtad imbatible.</p>
            <a href="javascript:void(0)" class="read-more" onclick="openArticleModal('crm')">Leer art√≠culo completo ‚Üí</a>
          </div>
          <!-- Article 2: WhatsApp -->
          <div class="article-card">
            <h4>Triple W: Winning WhatsApp Workflows</h4>
            <div class="article-meta" id="meta-whatsapp">Tecnolog√≠a | 8 de Octubre, 2025 | 7 min lectura</div>
            <!-- UPDATED BLOG COPY -->
            <p class="muted text-sm">**Convierte el chat en caja registradora.** Te mostramos 3 flujos esenciales de WhatsApp que garantizan la entrega de informaci√≥n clave y el cierre de ventas 24/7, liberando a tu equipo para tareas estrat√©gicas.</p>
            <a href="javascript:void(0)" class="read-more" onclick="openArticleModal('whatsapp')">Leer art√≠culo completo ‚Üí</a>
          </div>
          <!-- Article 3: Diagnosis -->
          <div class="article-card">
            <h4>El Diagn√≥stico de 60 Segundos: ¬øPor qu√© funciona?</h4>
            <div class="article-meta" id="meta-diagnosis">Producto | 1 de Octubre, 2025 | 3 min lectura</div>
            <!-- UPDATED BLOG COPY -->
            <p class="muted text-sm">Detr√°s de la inmediatez hay **inteligencia profunda.** Explicamos c√≥mo la arquitectura de Gemini nos permite aislar tu cuello de botella estrat√©gico en un minuto, ofreciendo una ruta de acci√≥n inmediata y sin rodeos.</p>
            <a href="javascript:void(0)" class="read-more" onclick="openArticleModal('diagnosis')">Leer art√≠culo completo ‚Üí</a>
          </div>
          <!-- Article 4: Growth Strategy -->
          <div class="article-card">
            <h4>Rompiendo el Bloqueo: De Tr√°fico a Dominio de Mercado</h4>
            <div class="article-meta" id="meta-growth">Crecimiento | 25 de Septiembre, 2025 | 6 min lectura</div>
            <!-- UPDATED BLOG COPY -->
            <p class="muted text-sm">El crecimiento no es lineal, es estrat√©gico. Desglosamos las **4 fases de la metodolog√≠a Trinity** para convertir una audiencia fr√≠a en un mercado cautivo, utilizando datos para una ejecuci√≥n Full Stack implacable.</p>
            <a href="javascript:void(0)" class="read-more" onclick="openArticleModal('growth')">Leer art√≠culo completo ‚Üí</a>
          </div>
          <!-- Article 5: Retention -->
          <div class="article-card">
            <h4>Metadata vs. Magia: La F√≥rmula de la Fidelizaci√≥n</h4>
            <div class="article-meta" id="meta-retention">Branding | 15 de Septiembre, 2025 | 4 min lectura</div>
            <!-- UPDATED BLOG COPY -->
            <p class="muted text-sm">La retenci√≥n es la nueva adquisici√≥n. Descubre c√≥mo usamos la **metadata (datos) para dise√±ar la "magia"** de las experiencias personalizadas que hacen que tus clientes no solo regresen, sino que se conviertan en promotores de tu marca.</p>
            <a href="javascript:void(0)" class="read-more" onclick="openArticleModal('retention')">Leer art√≠culo completo ‚Üí</a>
          </div>
        </div>
      </section>
    </div> <!-- end data-view="blog" -->

  </main>

  <!-- Modal (Now handles Diagnosis and Article View) -->
  <div id="modalBackdrop" class="modal-backdrop" role="dialog" aria-modal="true" aria-hidden="true">
    
    <!-- Container for Diagnosis Form/Result -->
    <div id="diagnosisModalContainer" class="modal" role="document" aria-labelledby="modalTitle">
      <button id="closeModalBtn" style="position:absolute;right:12px;top:12px;background:transparent;border:none;color:var(--muted);font-size:20px;cursor:pointer">‚úï</button>
      
      <!-- Form view -->
      <div id="formView">
        <h4 id="modalTitle">üöÄ Mini Diagn√≥stico Express</h4>
        <p class="small" style="margin-bottom:12px">Responde 3 preguntas estrat√©gicas. Tu ruta de crecimiento ser√° analizada por nuestra IA.</p>

        <form id="diagForm">
          <div class="field">
            <input type="text" name="nombre" placeholder="Tu nombre" required />
          </div>
          <div class="field">
            <input type="email" name="email" placeholder="Tu correo" required />
          </div>

          <div style="margin-top:6px" class="field">
            <label class="small block mb-2">¬øD√≥nde sientes tu mayor bloqueo?</label>
            <div class="radios">
              <label><input required type="radio" name="bloqueo" value="Tr√°fico, Visibilidad y Alcance en Redes Sociales"> üåê Tr√°fico ‚Äî Visibilidad</label>
              <label><input type="radio" name="bloqueo" value="Conversiones, Cierre de Ventas y Optimizaci√≥n del Embudo"> üìà Conversiones ‚Äî Cerrar ventas</label>
              <label><input type="radio" name="bloqueo" value="Fidelizaci√≥n, Retenci√≥n de Clientes y Lifetime Value"> ü§ù Fidelizaci√≥n ‚Äî Retenci√≥n</label>
            </div>
          </div>

          <input type="hidden" name="paquete" id="paqueteInput" value="general">

          <div style="display:flex;gap:10px;margin-top:12px;align-items:center;flex-wrap:wrap">
            <button type="submit" class="btn-primary" id="submitBtn">Ver mi ruta de crecimiento ‚Üí</button>
            <button type="button" id="resetBtn" class="btn-ghost">Reset</button>
            <div style="flex:1;text-align:right" class="small muted">Impulsado por Gemini IA.</div>
          </div>
        </form>
      </div>

      <!-- Result view (hidden initially) -->
      <div id="resultView" class="hidden">
        <div class="result" role="status" aria-live="polite">
          <h5 id="resultTitle"></h5>
          <p id="resultDesc"></p>
          <div style="display:flex;gap:10px;margin-top:10px;flex-wrap:wrap">
            <a id="resultPackBtn" class="btn-primary" href="#" target="_blank">Ver paquete recomendado</a>
            <a id="resultChatBtn" class="btn-ghost" href="#">Hablar con un estratega</a>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Container for Article Reading -->
    <div id="articleModalContainer" class="modal modal-lg hidden" role="document" aria-labelledby="articleTitle">
        <button id="closeArticleModalBtn" style="position:absolute;right:12px;top:12px;background:transparent;border:none;color:var(--muted);font-size:20px;cursor:pointer">‚úï</button>
        <h4 id="articleTitle" style="font-size: 24px;"></h4>
        <div class="article-meta" id="articleMeta" style="margin-bottom: 20px;"></div>
        <div id="articleContent" class="text-white">
            <!-- Article content will be loaded here -->
        </div>
        <!-- NEW CTA BLOCK -->
        <div class="mt-4 pt-4 border-t border-gray-800 flex justify-end">
            <button id="articleCTABtn" class="btn-primary">Ver paquete recomendado</button>
        </div>
    </div>
    
  </div>

  <!-- Floating chat (WhatsApp) -->
  <div class="chat" onclick="window.open('https://wa.me/573001234567','_blank')">üí¨</div>

  <!-- Footer Solicitado con Iconos de Redes Sociales -->
  <footer class="bg-[#0b0b0b] text-white p-6 mt-8 border-t border-gray-800">
      <!-- Contenedor principal: Justifica el espacio entre la info de autor y el contacto/social -->
      <div class="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0 text-center md:text-left container">

          <!-- Columna de Derechos de Autor / Texto Principal -->
          <div class="text-sm">
              <!-- El texto principal del footer, con el nombre, la marca y la filosof√≠a. Usando clases para adaptar al tema oscuro. -->
              <p class="font-semibold mb-1 text-gray-400">
                  Jhovanny S√°nchez - CLOEA by <span class="text-white font-bold">@Comosny</span> + <span class="text-[#d4af37]">IAmplifiying Human Frequency</span>
              </p>
              <p class="text-xs text-gray-600 mt-1">
                  Dise√±o impulsado por Gemini IA. ¬© 2025 Todos los derechos reservados.
              </p>
          </div>

          <!-- Grupo de Contacto (Email + Social) -->
          <div class="flex flex-col md:flex-row items-center space-y-3 md:space-y-0 md:space-x-8">
              
              <!-- Columna de Contacto / Email -->
              <div class="text-sm">
                  <a href="mailto:comosnythf@gmail.com" class="text-gray-400 hover:text-cyan-400 transition duration-300">
                      <!-- Icono de correo usando SVG -->
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline-block mr-1 align-middle" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8m-1 12H4a2 2 0 01-2-2V6a2 2 0 012-2h16a2 2 0 012 2v12a2 2 0 01-2 2z" />
                      </svg>
                      comosnythf@gmail.com
                  </a>
              </div>

              <!-- Bloque de Iconos de Redes Sociales -->
              <div class="flex space-x-4">
                  <!-- 1. Instagram -->
                  <a href="#" target="_blank" aria-label="Instagram" class="text-gray-400 hover:text-cyan-400 transition duration-300">
                      <svg fill="currentColor" viewBox="0 0 24 24" class="h-6 w-6"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.25.148 4.773 1.564 4.975 4.975.058 1.266.07 1.646.07 4.85s-.012 3.584-.07 4.85c-.148 3.25-1.564 4.773-4.975 4.975-1.266.058-1.646.07-4.85.07s-3.584-.012-4.85-.07c-3.25-.148-4.773-1.564-4.975-4.975-.058-1.266-.07-1.646-.07-4.85s.012-3.584.07-4.85c.148-3.25 1.564-4.773 4.975-4.975 1.266-.058 1.646-.07 4.85-.07zm0 2.138c-3.197 0-3.565.012-4.78.069-2.903.132-3.957 1.186-4.089 4.089-.057 1.215-.069 1.583-.069 4.78s.012 3.565.069 4.78c.132 2.903 1.186 3.957 4.089 4.089 1.215.057 1.583.069 4.78.069s3.565-.012 4.78-.069c2.903-.132 3.957-1.186 4.089-4.089.057-1.215.069-1.583.069-4.78s-.012-3.565-.069-4.78c-.132-2.903-1.186-3.957-4.089-4.089-1.215-.057-1.583-.069-4.78-.069zm0 6.648c-2.072 0-3.75 1.678-3.75 3.75s1.678 3.75 3.75 3.75 3.75-1.678 3.75-3.75-1.678-3.75-3.75-3.75zm0 2.138c.883 0 1.612.729 1.612 1.612s-.729 1.612-1.612 1.612-1.612-.729-1.612-1.612.729-1.612 1.612-1.612zm5.28-4.053c0 .345-.28.625-.625.625h-.002c-.345 0-.625-.28-.625-.625s.28-.625.625-.625h.002c.345 0 .625.28.625.625z"/></svg>
                  </a>
                  <!-- 2. Facebook -->
                  <a href="#" target="_blank" aria-label="Facebook" class="text-gray-400 hover:text-cyan-400 transition duration-300">
                      <svg fill="currentColor" viewBox="0 0 24 24" class="h-6 w-6"><path d="M14 10h-2v1.5h2v1h-2v4h-1v-4h-2v-1h2v-2c0-1.5 1-2 2-2h1v2zM21 0h-18c-1.657 0-3 1.343-3 3v18c0 1.657 1.343 3 3 3h18c1.657 0 3-1.343 3-3v-18c0-1.657-1.343-3-3-3zm1 19c0 1.102-.898 2-2 2h-18c-1.102 0-2-.898-2-2v-18c0-1.102.898-2 2-2h18c1.102 0 2 .898 2 2v18z"/></svg>
                  </a>
                  <!-- 3. LinkedIn -->
                  <a href="#" target="_blank" aria-label="LinkedIn" class="text-gray-400 hover:text-cyan-400 transition duration-300">
                      <svg fill="currentColor" viewBox="0 0 24 24" class="h-6 w-6"><path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm-2 16h-3v-9h3v9zm-1.5-10.732c-.974 0-1.764-.783-1.764-1.75s.789-1.75 1.764-1.75 1.764.783 1.764 1.75-.789 1.75-1.764 1.75zm10.5 10.732h-3v-5.604c0-3.368-4-3.528-4 0v5.604h-3v-9h3v1.765c1.396-2.586 7-2.777 7 2.493v4.742z"/></svg>
                  </a>
                  <!-- 4. YouTube -->
                  <a href="#" target="_blank" aria-label="YouTube" class="text-gray-400 hover:text-cyan-400 transition duration-300">
                      <svg fill="currentColor" viewBox="0 0 24 24" class="h-6 w-6"><path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm-3.842 16.593c-.309-.168-.501-.497-.501-.849v-7.488c0-.352.192-.681.501-.849l6.549-3.486c.31-.168.682-.168.991 0l6.549 3.486c.309.168.501.497.501.849v7.488c0 .352-.192.681-.501.849l-6.549 3.486c-.31.168-.682.168-.991 0l-6.549-3.486z"/></svg>
                  </a>
              </div>
          </div>

      </div>
  </footer>

  <script>
    // --- Gemini API Configuration ---
    const API_KEY = ""; // Canvas will provide this at runtime
    const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${API_KEY}`;
    const N8N_WEBHOOK = 'https://quantumcomosny.app.n8n.cloud/webhook-test/QuantumCore';
    
    // --- Package Details for CTA consistency ---
    const packageDetails = {
      impulso: { name: 'Impulso', title: 'üöÄ Ver Paquete Impulso' },
      crecimiento: { name: 'Crecimiento', title: 'üìà Ver Paquete Crecimiento' },
      dominio: { name: 'Dominio', title: 'üèÜ Ver Paquete Dominio' },
    };


    // --- Article Data (Content for Blog Modal) ---
    const articles = {
      crm: {
        title: "El Futuro del CRM: Automatizaci√≥n y Personalizaci√≥n",
        meta: "Estrategia | 12 de Octubre, 2025 | 5 min lectura",
        relatedPackage: 'dominio', // Fidelizaci√≥n y LTV -> Dominio
        content: `
          <p>El CRM ha evolucionado de ser un simple registro de contactos a una **central de inteligencia predictiva**. Ya no es suficiente con saber qui√©n es tu cliente; debes saber qu√© har√° a continuaci√≥n.</p>
          <p>En Trinity, vemos el CRM como el coraz√≥n de tu estrategia, no solo un buz√≥n de datos. Nuestra IA analiza patrones hist√≥ricos, interacciones en redes sociales, y comportamiento de navegaci√≥n para predecir cu√°ndo un cliente est√° a punto de comprar, desertar o recomendarte.</p>
          <h5>La Personalizaci√≥n a Escala</h5>
          <p>El desaf√≠o para muchas empresas es personalizar a nivel masivo. Aqu√≠ es donde Trinity interviene: segmentamos din√°micamente tu base de datos y automatizamos flujos de comunicaci√≥n (emails, WhatsApp, SMS) que se sienten 100% manuales y personales, activando la conversi√≥n en los puntos de fricci√≥n.</p>
          <p>Un CRM potenciado por IA es la clave para un ciclo de lealtad imbatible, asegurando que cada cliente se sienta visto y valorado, lo que impacta directamente en tu Lifetime Value (LTV).</p>
          <div class="mt-4 p-3 bg-gray-900 rounded-lg text-sm">
            **Conclusi√≥n Trinity:** Deja de gestionar contactos, empieza a gestionar relaciones rentables.
          </div>
        `
      },
      whatsapp: {
        title: "Triple W: Winning WhatsApp Workflows",
        meta: "Tecnolog√≠a | 8 de Octubre, 2025 | 7 min lectura",
        relatedPackage: 'crecimiento', // Conversi√≥n y Flujos -> Crecimiento
        content: `
          <p>WhatsApp es la plataforma de mensajer√≠a m√°s personal y el campo de batalla de la conversi√≥n moderna. Si no est√°s usando flujos automatizados, est√°s perdiendo ventas por la ventana.</p>
          <h5>3 Flujos Esenciales para Cerrar Ventas:</h5>
          <ol class="list-decimal list-inside ml-4 space-y-2 mt-2">
            <li>**El Retargeting Post-Inter√©s:** Un mensaje autom√°tico 24 horas despu√©s de que el usuario visit√≥ un producto espec√≠fico pero no compr√≥, con una oferta limitada o un recurso educativo.</li>
            <li>**La Alerta de Stock:** Notifica autom√°ticamente a los usuarios que preguntaron por un producto "agotado" tan pronto como vuelve a estar disponible. **¬°Conversi√≥n garantizada!**</li>
            <li>**El Post-Venta Estrat√©gica:** Enviar una encuesta breve y automatizada para calificar el servicio y, si es positiva, solicitar una rese√±a o una recomendaci√≥n inmediata.</li>
          </ol>
          <p class="mt-4">Nuestros flujos garantizan la entrega de informaci√≥n clave, mueven la aguja de la conversi√≥n y liberan a tu equipo comercial, permitiendo que la caja registradora trabaje 24/7.</p>
        `
      },
      diagnosis: {
        title: "El Diagn√≥stico de 60 Segundos: ¬øPor qu√© funciona?",
        meta: "Producto | 1 de Octubre, 2025 | 3 min lectura",
        relatedPackage: 'impulso', // Punto de partida / producto base -> Impulso
        content: `
          <p>La par√°lisis por an√°lisis es el peor enemigo del crecimiento. Nuestro Mini Diagn√≥stico no es magia, es arquitectura de inteligencia.</p>
          <h5>La Arquitectura de Precisi√≥n</h5>
          <p>Al forzar la elecci√≥n entre Tr√°fico, Conversi√≥n o Fidelizaci√≥n, el usuario se ve obligado a nombrar su dolor m√°s grande. Esta data, combinada con la capacidad de an√°lisis r√°pido de Gemini, nos permite clasificar el caso en segundos.</p>
          <p>La IA no solo genera el texto, sino que mapea la necesidad a la soluci√≥n m√°s efectiva de nuestro portafolio de servicios (Impulso, Crecimiento, Dominio), eliminando el proceso de venta largo e ineficiente que hace que los clientes huyan.</p>
          <p class="mt-4">El objetivo es simple: darte el camino, no el mapa completo. La claridad es el primer paso hacia la ejecuci√≥n implacable, y la IA es tu br√∫jula.</p>
        `
      },
      growth: {
        title: "Rompiendo el Bloqueo: De Tr√°fico a Dominio de Mercado",
        meta: "Crecimiento | 25 de Septiembre, 2025 | 6 min lectura",
        relatedPackage: 'crecimiento', // Escalado y Full Stack -> Crecimiento
        content: `<p>El crecimiento lineal est√° muerto. El crecimiento exponencial requiere una visi√≥n de Full Stack Marketing. La metodolog√≠a Trinity se basa en cuatro pilares: **Atracci√≥n (Tr√°fico), Nutrici√≥n (Conversi√≥n), Conversi√≥n (Venta) y Retenci√≥n (Fidelizaci√≥n).**</p><p class="mt-2">Desglosamos c√≥mo se utilizan los datos en cada fase para asegurar que cada d√≥lar gastado tenga el mayor retorno posible. Desde la optimizaci√≥n del *copy* de los anuncios hasta el dise√±o de la experiencia post-compra, todo es un experimento medible y escalable.</p><p class="mt-2">Dominar un mercado no se trata de ser el m√°s ruidoso, sino el m√°s estrat√©gico. Usa la IA para predecir y la ejecuci√≥n para conquistar, no al rev√©s.</p>`
      },
      retention: {
        title: "Metadata vs. Magia: La F√≥rmula de la Fidelizaci√≥n",
        meta: "Branding | 15 de Septiembre, 2025 | 4 min lectura",
        relatedPackage: 'dominio', // Fidelizaci√≥n y Data -> Dominio
        content: `<p>La magia de una marca ocurre cuando el cliente se siente especial. Pero la 'magia' real est√° impulsada por la **metadata**: datos demogr√°ficos, comportamiento de compra y patrones de uso.</p><p class="mt-2">Trinity utiliza esta metadata para crear 'momentos m√°gicos' a escala. Por ejemplo, si un cliente compra cada 30 d√≠as, la automatizaci√≥n se activa el d√≠a 28 con un incentivo personalizado, no gen√©rico. Es data predictiva aplicada al afecto, es decir, ¬°fidelizaci√≥n programada!</p><p class="mt-2">La retenci√≥n no es un departamento, es una filosof√≠a de negocio impulsada por la precisi√≥n de los datos, y es la forma m√°s barata de crecer.</p>`
      }
    };


    // --- Utility Function for Client-Side Routing ---
    const views = {
      '/': 'home',
      '/packs': 'packs',
      '/blog': 'blog'
    };

    function handleRoute(path) {
      const viewName = views[path] || views['/']; // Default to home view
      const viewElements = document.querySelectorAll('[data-view]');
      const navButtons = document.querySelectorAll('[data-link]');

      // Hide all views
      viewElements.forEach(view => {
        view.classList.add('hidden');
      });

      // Show the current view
      const currentView = document.querySelector(`[data-view="${viewName}"]`);
      if (currentView) {
        currentView.classList.remove('hidden');
        window.scrollTo({ top: 0, behavior: 'smooth' }); // Scroll to top on page change
      }

      // Update active navigation style
      navButtons.forEach(btn => {
        btn.classList.remove('active');
        if (btn.getAttribute('data-link') === path) {
          btn.classList.add('active');
        }
      });
      
      // Update the URL in the address bar
      if (window.location.pathname !== path) {
          history.pushState({ path: path }, '', path);
      }
    }
    
    // Listen for back/forward browser buttons
    window.addEventListener('popstate', () => {
      handleRoute(window.location.pathname);
    });
    
    // --- Utility Function for Exponential Backoff ---
    async function fetchWithRetries(url, options, maxRetries = 3) {
      for (let i = 0; i < maxRetries; i++) {
        try {
          const response = await fetch(url, options);
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          return response;
        } catch (error) {
          if (i === maxRetries - 1) throw error;
          const delay = Math.pow(2, i) * 1000 + Math.random() * 1000;
          await new Promise(resolve => setTimeout(resolve, delay));
        }
      }
    }

    // --- DOM ELEMENT REFERENCES (Grouping for robustness) ---
    const modalBackdrop = document.getElementById('modalBackdrop');
    
    // Diagnosis Elements
    const openDiagBtn = document.getElementById('openDiagBtn');
    const diagnosisModalContainer = document.getElementById('diagnosisModalContainer');
    const closeModalBtn = document.getElementById('closeModalBtn');
    const diagForm = document.getElementById('diagForm');
    const formView = document.getElementById('formView');
    const resultView = document.getElementById('resultView');
    const resultTitle = document.getElementById('resultTitle');
    const resultDesc = document.getElementById('resultDesc');
    const resultPackBtn = document.getElementById('resultPackBtn');
    const resultChatBtn = document.getElementById('resultChatBtn');
    const paqueteInput = document.getElementById('paqueteInput');
    const submitBtn = document.getElementById('submitBtn');
    const resetBtn = document.getElementById('resetBtn');

    // Article Elements
    const articleModalContainer = document.getElementById('articleModalContainer');
    const closeArticleModalBtn = document.getElementById('closeArticleModalBtn');
    const articleTitle = document.getElementById('articleTitle');
    const articleMeta = document.getElementById('articleMeta');
    const articleContent = document.getElementById('articleContent');
    const articleCTABtn = document.getElementById('articleCTABtn');

    // Video Elements
    const video = document.getElementById('heroVideo');
    const playPauseBtn = document.getElementById('playPauseBtn');
    const muteBtn = document.getElementById('muteBtn');


    // --- Modal logic (Shared components) ---

    function closeModal(){
      if (modalBackdrop) {
        modalBackdrop.classList.remove('open');
        modalBackdrop.setAttribute('aria-hidden','true');
      }
      // Hide both containers when closing the modal
      if (diagnosisModalContainer) diagnosisModalContainer.classList.add('hidden');
      if (articleModalContainer) articleModalContainer.classList.add('hidden');
    }

    // support keyboard Escape
    document.addEventListener('keydown', (e)=> {
      if (e.key === 'Escape') closeModal();
    });
    
    // --- Diagnosis Modal Logic ---

    function openDiagnosisModal() {
      // Hide article, show diagnosis
      if (articleModalContainer) articleModalContainer.classList.add('hidden');
      if (diagnosisModalContainer) diagnosisModalContainer.classList.remove('hidden');
      if (modalBackdrop) {
        modalBackdrop.classList.add('open');
        modalBackdrop.setAttribute('aria-hidden','false');
      }
      if (formView) formView.classList.remove('hidden');
      if (resultView) resultView.classList.add('hidden');
      // focus first input
      setTimeout(()=> {
          const firstInput = document.querySelector('#diagForm input[name="nombre"]');
          if(firstInput) firstInput.focus();
      },120);
    }

    // open modal from packages with preselection
    function openModalWithPackage(pkg){
      if (paqueteInput) paqueteInput.value = pkg;
      openDiagnosisModal();
    }
    window.openModalWithPackage = openModalWithPackage; // expose to inline onclick handlers

    // --- Article Modal Logic ---

    function openArticleModal(articleId) {
      const article = articles[articleId];
      if (!article) return;

      // 1. Hide diagnosis, show article
      if (diagnosisModalContainer) diagnosisModalContainer.classList.add('hidden');
      if (articleModalContainer) articleModalContainer.classList.remove('hidden');
      
      // 2. Load content
      if (articleTitle) articleTitle.textContent = article.title;
      if (articleMeta) articleMeta.textContent = article.meta;
      if (articleContent) {
          articleContent.innerHTML = article.content;
          articleContent.scrollTop = 0; // Scroll content to top
      }
      
      // 3. Set CTA based on relatedPackage
      const relatedPkgId = article.relatedPackage || 'impulso';
      const pkg = packageDetails[relatedPkgId];

      if (articleCTABtn) {
        articleCTABtn.textContent = pkg.title;
        articleCTABtn.onclick = () => {
            closeModal();
            handleRoute('/packs'); // Navigate to the packs page
        };
      }


      // 4. Open modal
      if (modalBackdrop) {
        modalBackdrop.classList.add('open');
        modalBackdrop.setAttribute('aria-hidden','false');
      }
    }
    window.openArticleModal = openArticleModal; // expose to inline onclick handlers


    // --- Form submit: Call Gemini API for diagnosis and send data to webhook ---
    function handleSubmit(e) {
      e.preventDefault();
      // Only proceed if diagForm exists
      if (!diagForm) return;

      const fd = new FormData(diagForm);
      const data = {};
      for (const [k,v] of fd.entries()) data[k] = v;
      
      const { nombre, email, bloqueo } = data;
      const originalBtnText = submitBtn ? submitBtn.textContent : 'Ver mi ruta...';

      // 1. Show processing state
      if (submitBtn) {
        submitBtn.innerHTML = '<span class="spinner">üåÄ</span> Procesando...';
        submitBtn.disabled = true;
      }

      // 2. Call Gemini API
      (async () => {
        try {
          const systemPrompt = `Eres Trinity, un experto estratega de marketing y autoconocimiento. Tu tarea es analizar el bloqueo de negocio de un usuario y ofrecer un diagn√≥stico estrat√©gico en un solo p√°rrafo (m√°ximo 5 oraciones), conciso y motivador. El diagn√≥stico debe ser profesional y persuasivo, enfocado en resolver el bloqueo. 
                                El diagn√≥stico debe concluir con una recomendaci√≥n CLARA de uno de estos tres paquetes: 'Impulso' (para visibilidad/tr√°fico), 'Crecimiento' (para conversi√≥n/automatizaci√≥n), o 'Dominio' (para estrategia integral/fidelizaci√≥n). 
                                Muestra tu an√°lisis y luego, al final del p√°rrafo, incluye el paquete recomendado entre corchetes, como en este ejemplo: '...Tu mejor ruta para activar la permanencia es el [Dominio].'`;
          
          const userQuery = `Mi nombre es ${nombre}, mi correo es ${email}, y mi mayor bloqueo actual es: "${bloqueo}". Dame mi diagn√≥stico y recomendaci√≥n de ruta para crecer.`;
          
          const payload = {
              contents: [{ parts: [{ text: userQuery }] }],
              tools: [{ "google_search": {} }],
              systemInstruction: {
                  parts: [{ text: systemPrompt }]
              },
          };

          const response = await fetchWithRetries(API_URL, {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify(payload)
          });

          const result = await response.json();
          const generatedText = result.candidates?.[0]?.content?.parts?.[0]?.text || 
                                "Disculpa, no pudimos generar tu diagn√≥stico. Por favor, contacta a nuestro equipo.";

          // 3. Extract recommended package using regex
          const match = generatedText.match(/\[(Impulso|Crecimiento|Dominio)\]/i);
          const recommendedPackage = match ? match[1].toLowerCase() : 'impulso';
          
          // Prepare title and clean description
          const description = generatedText.replace(/\[(Impulso|Crecimiento|Dominio)\]/i, '').trim();
          const packInfo = packageDetails[recommendedPackage] || packageDetails['impulso'];

          // 4. Update Result View
          if (resultTitle) resultTitle.textContent = packInfo.title;
          if (resultDesc) resultDesc.textContent = description;
          
          if (resultPackBtn) {
            // The resultPackBtn should navigate to the packs page, not open a modal
            resultPackBtn.href = `javascript:void(0);`; 
            resultPackBtn.onclick = () => {
                 closeModal();
                 handleRoute('/packs');
            };
            resultPackBtn.classList.remove('hidden');
          }


          // 5. Update Chat Link
          const packLabel = recommendedPackage.charAt(0).toUpperCase() + recommendedPackage.slice(1);
          if (resultChatBtn) {
            resultChatBtn.href = `https://wa.me/573001234567?text=${encodeURIComponent(`Hola, mi nombre es ${nombre} y he completado mi diagn√≥stico. Me interesa discutir el paquete ${packLabel}.`)}`;
            resultChatBtn.classList.remove('hidden');
          }

          if (formView) formView.classList.add('hidden');
          if (resultView) resultView.classList.remove('hidden');

        } catch (err) {
          console.error('Error al obtener el diagn√≥stico de Gemini:', err);
          if (resultTitle) resultTitle.textContent = '‚ùå Error en el Diagn√≥stico IA';
          if (resultDesc) resultDesc.textContent = 'Tuvimos un problema con la conexi√≥n de la IA. Por favor, int√©ntalo de nuevo o contacta a nuestro equipo de estrategas directamente.';
          if (resultPackBtn) resultPackBtn.classList.add('hidden');
          if (resultChatBtn) resultChatBtn.classList.remove('hidden');
          if (formView) formView.classList.add('hidden');
          if (resultView) resultView.classList.remove('hidden');
        } finally {
          // 6. Restore submit button
          if (submitBtn) {
            submitBtn.textContent = originalBtnText;
            submitBtn.disabled = false;
          }
          
          // 7. Fire and forget: Send data to N8N webhook (non-critical)
          try {
            await fetch(N8N_WEBHOOK, {
              method: 'POST',
              headers: {'Content-Type':'application/json'},
              body: JSON.stringify(data),
            });
          } catch (err) {
            console.warn('Error enviando a n8n (no cr√≠tico):', err);
          }
        }
      })();
    }

    // --- Video controls (kept original logic)
    let isPlaying = true;
    let isMuted = true;

    // --- Initialization function to run when DOM is ready ---
    function initialize() {
        // --- Navigation Init ---
        document.querySelectorAll('[data-link]').forEach(element => {
            element.addEventListener('click', (e) => {
                e.preventDefault();
                const path = element.getAttribute('data-link');
                handleRoute(path);
            });
        });
        handleRoute(window.location.pathname);
        
        // --- Video Init ---
        if (video) {
            video.play().catch(error => {
                console.warn("Autoplay was prevented, user intervention required.", error);
            });
        }
        if (playPauseBtn && muteBtn && video) {
            playPauseBtn.addEventListener('click', () => {
              if (video.paused) {
                video.play();
                isPlaying = true;
                playPauseBtn.textContent = 'Pause';
              } else {
                video.pause();
                isPlaying = false;
                playPauseBtn.textContent = 'Play';
              }
            });

            muteBtn.addEventListener('click', () => {
              video.muted = !video.muted;
              isMuted = video.muted;
              muteBtn.textContent = isMuted ? 'Unmute' : 'Mute';
            });
        }
        
        // --- Modal Listener Init ---
        if (closeModalBtn) closeModalBtn.addEventListener('click', closeModal);
        if (closeArticleModalBtn) closeArticleModalBtn.addEventListener('click', closeModal);

        if (modalBackdrop) {
          modalBackdrop.addEventListener('click', (e)=> {
            // Check if click target is the backdrop itself
            if (e.target === modalBackdrop) closeModal(); 
          });
        }

        // --- Diagnosis Listener Init ---
        if (openDiagBtn) {
            openDiagBtn.addEventListener('click', () => {
              if (paqueteInput) paqueteInput.value = 'general';
              openDiagnosisModal();
            });
        }

        if (resetBtn) {
          resetBtn.addEventListener('click', ()=> {
            if (diagForm) diagForm.reset();
            if (paqueteInput) paqueteInput.value = 'general';
            if (formView) formView.classList.remove('hidden');
            if (resultView) resultView.classList.add('hidden');
          });
        }

        if (diagForm) {
            diagForm.addEventListener('submit', handleSubmit);
        }
    }

    window.onload = initialize;
  </script>
</body>
</html>
